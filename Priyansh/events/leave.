module.exports.config = {
	name: "leave",
	eventType: ["log:unsubscribe"],
	version: "1.0.0",
	credits: "Mirai Team",
	description: "NYc MoVe",
	dependencies: {
		"fs-extra": "",
		"path": ""
	}
};

module.exports.run = async function({ api, event, Users, Threads }) {
	if (event.logMessageData.leftParticipantFbId == api.getCurrentUserID()) return;
  const fs = require("fs");
  const axios = require("axios");
  let {threadName, participantIDs, imageSrc} = await api.getThreadInfo(event.threadID);
            const type = (event.author == event.logMessageData.leftParticipantFbId) ? "ğ…ğšğ‘ğšğ‘ \nâ”‘(ï¿£â–½ï¿£)â”\n\n  â—â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â—\n  â—â—â—â”â”â”â”â”â—¥ğŸ–¤â—¤â”â”â”â”â”â—â—â—" : "ğŒğğ‘ğš ğ†ğ«ğ¨ğ®ğ© ğŒğğ‘ğ¢ ğŒğšğ«ğ™ğ¢ \n<(ï½€^Â´)>\n\n  â—â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â—\n  â—â—â—â”â”â”â”â”â—¥ğŸ–¤â—¤â”â”â”â”â”â—â—â—";
          let pathh = __dirname +`/cache/bye.png`;
          let name = (await api.getUserInfo(event.logMessageData.leftParticipantFbId))[event.logMessageData.leftParticipantFbId].name
  let avt = ["https://i.imgur.com/5LvOqCw.jpg", "https://i.imgur.com/jhg6oQy.jpg", "https://i.imgur.com/0Zle5Au.jpg", "https://i.imgur.com/5LvOqCw.jpg"]
   var avt1 = avt[Math.floor(Math.random() * avt.length)];
          let image = (
    await axios.get(`https://free-api.ainz-sama101.repl.co/canvas/goodbye2?name=${name}&uid=${event.logMessageData.leftParticipantFbId}&bg=${avt1}&member=${participantIDs.length}`, {
      responseType: "arraybuffer",
    })
  ).data;
  fs.writeFileSync(pathh, Buffer.from(image, "utf-8"));
            api.sendMessage({body:"     \n   â€¿ï¸µâ€¿ï¸µÊšËšÌ£Ì£Ì£Í™Éãƒ»â‰ãƒ» ÊšËšÌ£Ì£Ì£Í™Éâ€¿ï¸µâ€¿ï¸µ\nâ”€â”â”€â”€â ğğ˜ğœ ğŒğ¨ğ•ğ ââ”€â”€â”â”€\n â—â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â–¬â—\n\n " + name+" âœˆï¸ " + type, attachment: fs.createReadStream(pathh)}, event.threadID)
	
}

